<!DOCTYPE html>
<html lang="zh">

  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>登录 - EasyAPI服务平台</title>
    <link href="https://cdn.bootcss.com/twitter-bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://static.easyapi.com/styles/base.css" rel="stylesheet" />
    <link href="https://cdn.bootcss.com/jQuery-Validation-Engine/2.6.4/validationEngine.jquery.min.css" rel="stylesheet" />
    <meta name="descriptions" content="EasyAPI账号登录" />
    <meta name="keywords" content="登录" />
    <link href="/favicon.ico" rel="shortcut icon" type="image/x-icon">
  </head>

  <body>
    <div style="margin: 0 0 100px 0">
      <div class="toper">
        <div class="wp">
          <a href="https://www.easyapi.com/"><img class="logo pl" src="https://static.easyapi.com/images/logo.png" /></a>

        </div>
      </div>
    </div>

    <div class="container">
      <div class="lg-form yahei">
        <div class="lg-title ">用户登录</div>
        <div class="lg-body bgf">
          <form method="post" class="login-form" id="loginForm" onsubmit="">
            <div id="alert" class="alert in alert-warning none">
              无效用户名或密码，请重试。
            </div>
            <br />
            <div class="form-group">
              <input class="form-control" id="username" placeholder="请输入您注册时手机号码" name="username" type="text" />
            </div>
            <div class="form-group">
              <input placeholder="请输入密码" class="form-control" type="password" name="password" id="password" />
            </div>
            <div class="checkbox">
              <label>
                <input type="checkbox" name="rememberMe" id="rememberMe" checked="checked" v />
                记住密码 </label> <span class="Validform_checktip" id="msg2"></span>
            </div>

            <input id="btn_sub" type="button" name="login" class=" btn-block btn btn-lg btn-info" value="登 录" onclick="_login()" />

          </form>
        </div>
      </div>
    </div>

    <script src="https://cdn.bootcss.com/jquery/3.5.1/jquery.min.js" type="text/javascript"></script>
    <script type="text/javascript" src="https://cdn.bootcdn.net/ajax/libs/layer/3.1.1/layer.min.js"></script>
    <script type="text/javascript">
      var url = sessionStorage['url'];
      //登录
      function _login() {

        $.ajax({
          method: 'POST',
          url: 'https://account-api.easyapi.com/api/authenticate',
          cache: false,
          contentType: 'application/json',
          data: JSON.stringify({
            username: $('#username').val(),
            password: $("#password").val(),
            rememberMe: $("#rememberMe").is(":checked")
          }),
          processData: false,
          dataType: "json",
          success: function(data) {
            console.log(data)
            if (data.code == 1) {

              sessionStorage['token'] = data.id_token;

              var _url = "https://account.easyapi.com/auth/authorize.html" + url;
              console.log(_url)

              window.location.href = _url;
            }
          },
          error: function(res) {
            layer.msg("用户名或密码不正确", {
              icon: 2,
              time: 2000
            });
          }
        })
      }
    </script>
  </body>

</html>
