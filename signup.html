
<!DOCTYPE html>
<html lang="zh">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>注册 - EasyAPI服务平台</title>
    <link href="https://apps.bdimg.com/libs/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet"/>
    <link href="https://static.easyapi.com/styles/base.css" rel="stylesheet"/>
    <meta name="descriptions" content="EasyAPI账号注册"/>
    <meta name="keywords" content="注册"/>
    <link href="/favicon.ico" rel="shortcut icon" type="image/x-icon">
</head>
<body>
<div style="margin: 0 0 100px 0">
    <div class="toper">
        <div class="wp">
            <a href="https://www.easyapi.com/"><img class="logo pl" src="https://static.easyapi.com/images/logo.png"/></a>
            <div class="navs pr">
                <a href="/login">登录</a>
                <a href="/signup">注册</a>
            </div>
        </div>
    </div>
</div>

<div class="container mt">
    <div class="lg-form">
        <div class="ath"><img src="https://static.easyapi.com/images/ath2.png"></div>
        <div class="lg-title text-center">用户注册</div>
        <div class="lg-body bgf">
            <form method="post" class="" id="emailForm" name="emailForm" action="" onsubmit="return findEmail();">
                <input type="hidden" id="redirect" name="redirect" value="/user/email">
                <br/>

                <div class="form-group">
                    <input id="username" datatype="e" nullmsg="请输入邮箱！" errormsg="邮箱格式有误！"
                           name="user.username" type="text" size="20" class="form-control" alt="用户名"
                           placeholder="请输入邮箱, 例如 bangqu@easyapi.com" validate="['required']">
                </div>

                <div class="form-group">
                    <input type="submit" id="signup" name="signup" class=" btn-block btn btn-lg btn-info" value="下一步"/>
                </div>
                <span class="Validform_checktip " id="msg2"></span>

                <div class="otherbox">
                    <a href="/login" class="btn  btn-lg btn-default">我已有EasyAPI账号，直接登录</a>
                </div>
            </form>
        </div>
    </div>
</div>

<div class="foot clearfix">
    <p>
        <a href="https://www.easyapi.com/info/about">关于我们</a>
        <a href="https://www.easyapi.com/info/together">合作伙伴</a>
        <a href="https://www.easyapi.com/info/contact">联系我们</a>
        <a href="https://www.easyapi.com/info/donate">支持我们</a>
    </p>
    <p>Copyright © 2014～2017 上海帮趣网络技术有限公司</p>
</div>

<script src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js" type="text/javascript"></script>
<script src="https://apps.bdimg.com/libs/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script src="https://static.easyapi.com/scripts/base.js"></script>
<script type="text/javascript" src="https://static.easyapi.com/layer/layer.js"></script>
<script type="text/javascript" src="https://static.easyapi.com/scripts/jquery.jsonp.js"></script>
<script type="text/javascript" src="https://static.easyapi.com/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script type="text/javascript" src="https://static.easyapi.com/scripts/libs/Validform_v5.3.2_min.js"></script>
<script type="text/javascript">
    var from = "";
    if (from != null && from != '') {
        var expiresDate= new Date();
        expiresDate.setTime(expiresDate.getTime() + (60 *60 *1000));
        $.cookie('from', from, { expires: expiresDate });
    } else {
        from = $.cookie("from");
    }
    if ( typeof(from) == "undefined") {
        from = '';
    }
    $("#emailForm").Validform({
        tiptype: function (msg, o, cssctl) {
            var objtip = $("#msg2");
            cssctl(objtip, o.type);
            objtip.text(msg);
        }
    });

    function findEmail() {
        var username = $("#username").val();
        $.ajax({
            url: "/api/account/find",
            contentType: 'text/plain',
            method: "POST",
            data: username,
            dataType: "text",
            success: function (data) {
                $("#msg2").text("此邮箱已经被人注册").addClass("Validform_wrong");
                ;
            },
            error: function (data) {
                sendEmail(username);
            }
        });
        return false;
    }

    function sendEmail(email) {
        $.ajax({
            method: 'POST',
            url: '/api/account/signup/activation',
            contentType: 'text/plain',
            data: email,
            dataType: "text",
            success: function (data) {
                window.location.replace("/signup/email?username=" + email);
            }
        });
    }

</script>
</body>
</html>